# 测试报告

成员：秦嘉余 赖烨文 刘永鹏 孙文戈 张城铨 蒋梓栩

日期： 2022年6月4日



[TOC]













## 引言

### 编写目的

为了发现和报告南大测试中心后端的错误和缺陷。通过测试，确保本系统的功能、互操作性等符合软件的设计要求，满足用户的使用要求。通过分析错误产生的原因和错误的分布特征，可以帮助项目管理者发现当前所采用的软件过程的缺陷，以便对系统进行升级时进行改进。



### 项目背景

“南大测试在线管理平台”是一个接受客户在线提交委托，由南京大学软件测试中心分配人员，帮助客户进行软件测试的应用。

“南大测试在线管理平台”为客户与测试中心之间的交互提供平台，客户可以使用移动设备或计算机在网页上进行操作，上传各类文件，并查看自己委托的当前进展；测试中心可以通过平台发送测试文件、测试报告给对应的客户。平台会保留委托进行过程中的每一次操作记录，并生成历史记录以供客户或管理员进行查询。



### 参考资料

- ruoyi-vue-pro 开发指南
- 测试报告实例





## 测试概要

### 测试环境

| 类型     | 名称                  |
| -------- | --------------------- |
| 操作系统 | Windows 10，11或Linux |
| IDE      | Intellij  IDEA        |
| 支撑软件 | JDK 11，H2            |

### 测试工具

单元测试使用Junit。

Junit是一个开源的Java单元测试框架，是Java的标准单元测试库。Junit测试是程序员主导的测试，即白盒测试，以证明某段代码的行为确实与开发者所期望的一致。Junit的断言机制，可以直接将我们的预期结果和程序运行的结果进行一个比对，确保对结果的可预知性。

性能测试使用JunitPerf,JunitPerf是基于装饰器的Junit扩展框架,测试中通过JunitPerf多线程调用接口测试并可以规定预计时间。

集成测试使用Apifox的测试套件，测试套件为测试用例的集合，每个测试套件包含多个测试用例。



## 测试内容

### 测试过程

#### 单元测试
单元测试对各个部分Service进行测试，为了与项目真实数据库隔离开来，单元测试使用H2数据库，每个单元测试运行前会首先运行H2建表语句并在运行结束后进行H2删库操作。

利用Mockito框架虚拟出一个外部依赖，降低测试组件之间的耦合度，只注重代码的流程与结果，真正地实现测试目的。在测试某个Service环节中，单元测试会模拟出其他Service（用@MockBean引入），但是对测试Service和相关数据（Mapper）真实引入（@Resource）。

##### 委托

![image-20220604154452470](测试报告.assets/image-20220604154452470.png)



因为单元测试逻辑基本相同,下面就提交委托单元测试的逻辑加以说明。

![image-20220604155144393](测试报告.assets/image-20220604155144393.png)

因为DelegationService的submitDelegation方法需要获得相关user的相关身份,这里

```
Mockito.when(userService.getUser(any())).thenReturn(new AdminUserDO());
```
会返回一个用户,下面使用UUID生成一个id是因为之后需要多线程测试,防止多个线程向数据库里多次插入同一个ID。

之后构造一个DelegationDO插入数据库,注意此时需要将其状态改为待提交,因为这里单元测试多是对流程是否正确进行的测试,构造的新数据需要处于待提交的状态,然后构造请求参数submitReqVO调用DelegationService的submitDelegation,最后通过之前生成delegationId到数据库里查询DelegationDO的状态是否是委托提交后应有的状态。



##### 合同

![image-20220604162007775](测试报告.assets/image-20220604162007775.png)



##### 样品

![image-20220604163423034](测试报告.assets/image-20220604163423034.png)



##### 测试方法

![image-20220604163024553](测试报告.assets/image-20220604163024553.png)



##### 测试报告

![image-20220604173945312](测试报告.assets/image-20220604173945312.png)



##### 公司

![image-20220604181630564](测试报告.assets/image-20220604181630564.png)

##### 

##### 授权

![image-20220604184903955](测试报告.assets/image-20220604184903955.png)



##### 日志

![image-20220604185446333](测试报告.assets/image-20220604185446333.png)





#### 性能测试

通过JunitPerf在Junit原本的注解上增加如下注解:

```
 @JunitPerfConfig(threads = 8, warmUp = 0, duration = 1000,reporter = {HtmlReporter.class})
    @JunitPerfRequire(min = 210, max = 250, average = 225, timesPerSecond = 4, percentiles = {"20:220", "50:230"})
```

约定同时开启8个线程开始测试,最大时延不得超过250ms,最低时延不得低于210ms,每秒调用不得低于4次。





#### 集成测试

使用Apifox的自动化测试,创建各个阶段测试用例并发出请求:

![image-20220604191326955](测试报告.assets/image-20220604191326955.png)

具体测试客户-创建委托如下:

![image-20220604191646926](测试报告.assets/image-20220604191646926.png)

集成测试对过程中需要的变量提取保存并加入适当数据库操作,将测试用例按顺序组成测试套件,

考虑流程图中的不同意打回组成多个测试套件。

![image-20220604192125532](测试报告.assets/image-20220604192125532.png)



### 测试结果
#### 单元测试

##### 委托

![image-20220604192828135](测试报告.assets/image-20220604192828135.png)

##### 合同

![image-20220604193024283](测试报告.assets/image-20220604193024283.png)

##### 样品

![image-20220604193232319](测试报告.assets/image-20220604193232319.png)

##### 测试方案

![image-20220604193351013](测试报告.assets/image-20220604193351013.png)

##### 测试报告

![image-20220604193518732](测试报告.assets/image-20220604193518732.png)

##### 公司

![image-20220604193654701](测试报告.assets/image-20220604193654701.png)

##### 日志

![image-20220604194220799](测试报告.assets/image-20220604194220799.png)

测试覆盖率如下:

![image-20220604194339698](测试报告.assets/image-20220604194339698.png)



#### 性能测试
##### 委托(测试结果以委托为例)

<img src="测试报告.assets/image-20220605141028043.png" alt="image-20220605141028043" style="zoom:80%;" />

<img src="测试报告.assets/image-20220605141047157.png" alt="image-20220605141047157" style="zoom:80%;" />

<img src="测试报告.assets/image-20220605141106892.png" alt="image-20220605141106892" style="zoom:80%;" />

<img src="测试报告.assets/image-20220605141230195.png" alt="image-20220605141230195" style="zoom:80%;" />

<img src="测试报告.assets/image-20220605141251036.png" alt="image-20220605141251036" style="zoom:80%;" />

<img src="测试报告.assets/image-20220605141306444.png" alt="image-20220605141306444" style="zoom:80%;" />

<img src="测试报告.assets/image-20220605141349518.png" alt="image-20220605141349518" style="zoom:80%;" />

<img src="测试报告.assets/image-20220605141402661.png" alt="image-20220605141402661" style="zoom:80%;" />

<img src="测试报告.assets/image-20220605141522547.png" alt="image-20220605141522547" style="zoom:80%;" />

<img src="测试报告.assets/image-20220605141536043.png" alt="image-20220605141536043" style="zoom:80%;" />

<img src="测试报告.assets/image-20220605141556970.png" alt="image-20220605141556970" style="zoom:80%;" />

<img src="测试报告.assets/image-20220605141608046.png" alt="image-20220605141608046" style="zoom:80%;" />

<img src="测试报告.assets/image-20220605141629239.png" alt="image-20220605141629239" style="zoom:80%;" />

<img src="测试报告.assets/image-20220605141643571.png" alt="image-20220605141643571" style="zoom:80%;" />

<img src="测试报告.assets/image-20220605141653878.png" alt="image-20220605141653878" style="zoom:80%;" />

<img src="测试报告.assets/image-20220605141704695.png" alt="image-20220605141704695" style="zoom:80%;" />

<img src="测试报告.assets/image-20220605141715017.png" alt="image-20220605141715017" style="zoom:80%;" />

<img src="测试报告.assets/image-20220605141729346.png" alt="image-20220605141729346" style="zoom:80%;" />

<img src="测试报告.assets/image-20220605141741571.png" alt="image-20220605141741571" style="zoom:80%;" />


#### 集成测试

![image-20220604194521913](测试报告.assets/image-20220604194521913.png)

![image-20220604194605084](测试报告.assets/image-20220604194605084.png)



## 测试总结

测试已完成部分，功能正确，运行良好。

数据库中某些数据设置长度过少导致插入失败，现已修改。